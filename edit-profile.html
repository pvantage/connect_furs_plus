<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<title>Animal App</title>
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/style.css">
<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/function.js"></script>
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript">
 checkLogin();
</script>
</head>
<body class="bottom-links-bar">
<nav class="navbar navbar-expand-lg navbar-light bg-light navmainsection">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation"> 
    <span class="navbar-toggler-icon"><img src="images/menubar.png"/></span>
  </button>
  
  <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
      <li class="nav-item active">
        <a class="nav-link" href="swipe.html">Home <span class="sr-only">Profile</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="javascript:void(0);">Setting</a>
     </li>
	   <li class="nav-item">
        <a class="nav-link" href="javascript:void(0);" onClick="logOut();">Logout</a>
    </ul>
  </div>
</nav>

<div class="container">
    <div class="edit-profile mt-4">
        <h1 class="red">EDIT PROFILE</h1>
        <form>            
            <div class="form-group">
                <label><span class="reqfield">*</span>Owner Name:</label>
                <input type="text" name="name" id="name" placeholder="Please enter owner name." class="form-control">
            </div>
            <div class="form-group">
                <label><span class="reqfield">*</span>Pet Name:</label>
                <input type="text" name="petname" id="petname" placeholder="Please enter pet name." class="form-control">
            </div>
            
            <div class="form-group">
                <label><span class="reqfield">*</span>Pet Age <small>(Number Only)</small>:</label>
                <input type="number" name="petage" id="petage" placeholder="Please enter pet age." class="form-control">
            </div>
            <div class="form-group">
                <label><span class="reqfield">*</span>Pet Sex </label>
                <select class="form-control" name="sex" id="sex">
                    <option value="male">Male </option>
                    <option value="female">Female </option>
                </select>
            </div>
            
            
            <div class="form-group">
                <label>Tell us about your pet</label>
                <textarea class="form-control" name="aboutpet" id="aboutpet" tabindex="4"></textarea>
            </div>
            
            <div class="form-group">
                <label><span class="reqfield">*</span>Pet Location:</label>
                <input type="text" name="petlocation" id="petlocation" placeholder="Please enter pet location i.e city, state" class="form-control">
            </div>
            <div class="form-group">
                <label><span class="reqfield">*</span>Distance willing to Look (miles)</label>
                <select class="form-control" name="willing_distance" id="willing_distance" tabindex="5">
                    <option value="">Please select</option>
                    <option value="1"> 1 Miles</option>
                    <option value="2"> 2 Miles</option>
                    <option value="3"> 3 Miles</option>
                    <option value="4"> 4 Miles</option>
                    <option value="5"> 5 Miles</option>
                    <option value="6"> 6 Miles</option>
                    <option value="7"> 7 Miles</option>
                    <option value="8"> 8 Miles</option>
                    <option value="9"> 9 Miles</option>
                    <option value="10"> 10 Miles</option>
                    <option value="11"> 11 Miles</option>
                    <option value="12"> 12 Miles</option>
                    <option value="13"> 13 Miles</option>
                    <option value="14"> 14 Miles</option>
                    <option value="15"> 15 Miles</option>
                    <option value="16"> 16 Miles</option>
                    <option value="17"> 17 Miles</option>
                    <option value="18"> 18 Miles</option>
                    <option value="19"> 19 Miles</option>
                    <option value="20"> 20 Miles</option>
                </select>
            </div>
            
            <div class="form-group">
                <label><span class="reqfield">*</span>Who do you want to play/breeding with </label>
                <select class="form-control" name="who_play_breed" id="who_play_breed" tabindex="6">
                    <option value="0">Any Pet </option>
                    <option value="1">Just my breed </option>
                    <option value="2">Specific breed </option>
                </select>
            </div>
            
            <div class="form-group" id="breed_specific">
                <label><span class="reqfield">*</span>Select Breed </label>
                <select class="form-control" name="specific_breed" id="specific_breed" tabindex="7">
                </select>
            </div>
            
            <div class="form-group">
                <label>What color is your animal?</label>
                <input type="text" name="pet_color" id="pet_color" class="form-control" tabindex="8">
            </div>
			
			<div class="form-group uploadbtns">
            <label>Change Profile Pics</label>
			<div class="upbtn"><img class="mainpic img_upload" src="images/profile.jpg" id="pet_image_src"  onclick="getImage();">
            <input type="hidden" name="pet_image" id="pet_image">
			<div class="smallimg">
            	<img class="img_upload" src="images/multiple.jpg" id="src_pet_image_1" onclick="getImage1();">
                <input type="hidden" name="pet_image_1" id="pet_image_1">
            	<img class="img_upload" src="images/multiple.jpg" id="src_pet_image_2" onclick="getImage2();">
                <input type="hidden" name="pet_image_2" id="pet_image_2">
            	<img class="img_upload" src="images/multiple.jpg" id="src_pet_image_3" onclick="getImage3();">
                <input type="hidden" name="pet_image_3" id="pet_image_3">  
			 	<img class="img_upload" src="images/multiple.jpg" id="src_pet_image_4" onclick="getImage4();">
                <input type="hidden" name="pet_image_4" id="pet_image_4">
             </div>
			</div>
                
                <p class="error_msg" style="display:none;">Please upload pet image.</p>                
            </div>            
            <button type="button" class="btn btn-danger btn-block" onClick="addProfileinfo();">UPDATE</button>
        </form>
    </div>
</div>
<div class="bottom-fixed-bar">
    <div class="container">
        <table class="table">
             <tr>
                <td><a href="edit-profile.html"><img src="images/user-icon.png" alt=""></a></td>
                <td class="text-center"><a href="your-connections.html"><img src="images/heart-icon.png" alt=""></a></td>
                <td class="text-right"><a href="forums.html"><img src="images/chat-icon.png" alt=""></a></td>
            </tr>
        </table>
    </div>
</div>

<div class="modal fade modelcommon" id="modal_common" role="dialog">
              <div class="modal-content">
                <button class="close close_multi" data-dismiss="modal">X</button>                
                <div id="common_popup">
                  
                </div> 
  </div>
</div>
            
<div class="loadermain" id="loadingImg"></div>

<script type="text/javascript">
  function getImage() {             
           navigator.camera.getPicture(uploadPhoto, function(message){						
			//alert('Error!!');
			
		},{
			quality: 40, 
			correctOrientation: true,
			allowEdit : true,
			targetWidth: 200,
            targetHeight: 200,						
			destinationType: navigator.camera.DestinationType.FILE_URI,
			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
		}
            );
 
        }
 
        function uploadPhoto(imageURI) {
			$("#loadingImg").fadeIn();
			
			var upload_url = siteurl + 'account/upload';			
            var options1 = new FileUploadOptions();
            options1.fileKey="file";
            options1.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
            options1.mimeType="image/jpeg";
 
            var params1 = new Object();
            params1.value1 = "test";
            params1.value2 = "param";
 
            options1.params1 = params1;
            options1.chunkedMode = false;
 
            var ft1 = new FileTransfer();
            ft1.upload(imageURI, upload_url, win, fail, options1);
        }
 
        function win(r){
            $("#loadingImg").fadeOut();
			var resturn_data_1 = jQuery.parseJSON(r.response);
			
			if(resturn_data_1.success)
			{
				$('#pet_image_src').attr('src', resturn_data_1.success);				
				$('input[name="pet_image"]').val(resturn_data_1.img_name);
			}else if(resturn_data_1.error)
			{				
				$('#common_popup').html(resturn_data_1.error);
				$('#modal_common').modal('show');
			}
            
        }
 
        function fail(error) {
           $("#loadingImg").fadeOut();
		   $('#common_popup').html('Failed to upload');
			$('#modal_common').modal('show');
			
        }
</script>


<script type="text/javascript">
  function getImage1() {             
           navigator.camera.getPicture(uploadPhoto1, function(message){						
			//alert('Error!!');
			
		},{
			quality: 40, 
			correctOrientation: true,
			allowEdit : true,
			targetWidth: 200,
            targetHeight: 200,						
			destinationType: navigator.camera.DestinationType.FILE_URI,
			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
		}
            );
 
        }
 
        function uploadPhoto1(imageURI) {
			$("#loadingImg").fadeIn();
			
			var upload_url = siteurl + 'account/upload';			
            var options1 = new FileUploadOptions();
            options1.fileKey="file";
            options1.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
            options1.mimeType="image/jpeg";
 
            var params1 = new Object();
            params1.value1 = "test";
            params1.value2 = "param";
 
            options1.params1 = params1;
            options1.chunkedMode = false;
 
            var ft1 = new FileTransfer();
            ft1.upload(imageURI, upload_url, win1, fail, options1);
        }
 
        function win1(r){
            $("#loadingImg").fadeOut();
			var resturn_data_1 = jQuery.parseJSON(r.response);
			
			if(resturn_data_1.success)
			{
				$('#src_pet_image_1').attr('src', resturn_data_1.success);				
				$('input[name="pet_image_1"]').val(resturn_data_1.img_name);
			}else if(resturn_data_1.error)
			{								
				//alert(resturn_data_1.error);
				$('#common_popup').html(resturn_data_1.error);
				$('#modal_common').modal('show');
			}
            
        }       
</script>

<script type="text/javascript">
  function getImage2() {             
           navigator.camera.getPicture(uploadPhoto2, function(message){						
			//alert('Error!!');
			
		},{
			quality: 40, 
			correctOrientation: true,
			allowEdit : true,
			targetWidth: 200,
            targetHeight: 200,						
			destinationType: navigator.camera.DestinationType.FILE_URI,
			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
		}
            );
 
        }
 
        function uploadPhoto2(imageURI) {
			$("#loadingImg").fadeIn();
			
			var upload_url = siteurl + 'account/upload';			
            var options1 = new FileUploadOptions();
            options1.fileKey="file";
            options1.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
            options1.mimeType="image/jpeg";
 
            var params1 = new Object();
            params1.value1 = "test";
            params1.value2 = "param";
 
            options1.params1 = params1;
            options1.chunkedMode = false;
 
            var ft1 = new FileTransfer();
            ft1.upload(imageURI, upload_url, win2, fail, options1);
        }
 
        function win2(r){
            $("#loadingImg").fadeOut();
			var resturn_data_1 = jQuery.parseJSON(r.response);
			
			if(resturn_data_1.success)
			{
				$('#src_pet_image_2').attr('src', resturn_data_1.success);				
				$('input[name="pet_image_2"]').val(resturn_data_1.img_name);
			}else if(resturn_data_1.error)
			{								
				//alert(resturn_data_1.error);
				$('#common_popup').html(resturn_data_1.error);
				$('#modal_common').modal('show');
			}
            
        }       
</script>

<!---- upload 3 -->
<script type="text/javascript">
function getImage3() {             
           navigator.camera.getPicture(uploadPhoto3, function(message){						
			//alert('Error!!');
			
		},{
			quality: 40, 
			correctOrientation: true,
			allowEdit : true,
			targetWidth: 200,
            targetHeight: 200,						
			destinationType: navigator.camera.DestinationType.FILE_URI,
			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
		}
            );
 
}
 
function uploadPhoto3(imageURI) {
			$("#loadingImg").fadeIn();
			
			var upload_url = siteurl + 'account/upload';			
            var options1 = new FileUploadOptions();
            options1.fileKey="file";
            options1.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
            options1.mimeType="image/jpeg";
 
            var params1 = new Object();
            params1.value1 = "test";
            params1.value2 = "param";
 
            options1.params1 = params1;
            options1.chunkedMode = false;
 
            var ft1 = new FileTransfer();
            ft1.upload(imageURI, upload_url, win3, fail, options1);
        }
 
        function win3(r){
            $("#loadingImg").fadeOut();
			var resturn_data_1 = jQuery.parseJSON(r.response);
			
			if(resturn_data_1.success)
			{
				$('#src_pet_image_3').attr('src', resturn_data_1.success);				
				$('input[name="pet_image_3"]').val(resturn_data_1.img_name);
			}else if(resturn_data_1.error)
			{			
				$('#common_popup').html(resturn_data_1.error);
				$('#modal_common').modal('show');
			}
            
        }       
</script>
<!--- end upload 3 -->

<!---- upload 3 -->
<script type="text/javascript">
function getImage4() {             
           navigator.camera.getPicture(uploadPhoto4, function(message){						
			//alert('Error!!');
			
		},{
			quality: 40, 
			correctOrientation: true,
			allowEdit : true,
			targetWidth: 200,
            targetHeight: 200,						
			destinationType: navigator.camera.DestinationType.FILE_URI,
			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
		}
            );
 
}
 
function uploadPhoto4(imageURI) {
			$("#loadingImg").fadeIn();
			
			var upload_url = siteurl + 'account/upload';			
            var options1 = new FileUploadOptions();
            options1.fileKey="file";
            options1.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
            options1.mimeType="image/jpeg";
 
            var params1 = new Object();
            params1.value1 = "test";
            params1.value2 = "param";
 
            options1.params1 = params1;
            options1.chunkedMode = false;
 
            var ft1 = new FileTransfer();
            ft1.upload(imageURI, upload_url, win4, fail, options1);
        }
 
        function win4(r){
            $("#loadingImg").fadeOut();
			var resturn_data_1 = jQuery.parseJSON(r.response);
			
			if(resturn_data_1.success)
			{
				$('#src_pet_image_4').attr('src', resturn_data_1.success);				
				$('input[name="pet_image_4"]').val(resturn_data_1.img_name);
			}else if(resturn_data_1.error)
			{								
				$('#common_popup').html(resturn_data_1.error);
				$('#modal_common').modal('show');
			}
            
        }       
</script>
<!--- end upload 3 -->
<script type="text/javascript">
var login_id = localStorage.getItem('cust_id');

$.ajax({
	 type: 'POST',
	 url: siteurl + 'common/common/getbreedbylogin',
	 dataType: 'json',
	 data: {login_id:login_id},
	 crossDomain: true,
	 success: function(data){
		 	$('#specific_breed').html(data['success']);
	   }
});

$(document).ready(function(e){	
	$('select[name="who_play_breed"]').on('change',function(){
		if($(this).val() == 2) $('#breed_specific').show();
		else $('#breed_specific').hide();
	});
	
	$('select[name="who_play_breed"]').trigger('change');
});

function addProfileinfo(){
	var name = $('#name').val();
	var petname = $('#petname').val();
	var aboutpet = $('#aboutpet').val();
	var willing_distance = $('#willing_distance').val();
	var who_play_breed = $('#who_play_breed').val();
	var pet_color = $('#pet_color').val();
	var pet_image = $('input[name="pet_image"]').val();
	
	var petage = $('#petage').val();
	var petlocation = $('#petlocation').val();
	
	var breed_specific = '';
	if(who_play_breed == 2)
	{
		breed_specific = $('#specific_breed').val();
	}
	
	var image_1 = '';
	var image_2 = '';
	var image_3 = '';
	var image_4 = '';
	
	if($('#pet_image_1').val() != '')
	{
		image_1 = $('#pet_image_1').val();		
	}
	
	if($('#pet_image_2').val() != '')
	{
		image_2 = $('#pet_image_2').val();		
	}
	
	if($('#pet_image_3').val() != '')
	{
		image_3 = $('#pet_image_3').val();		
	}
	
	if($('#pet_image_4').val() != '')
	{
		image_4 = $('#pet_image_4').val();		
	}
	
	
	
	$.ajax({
	 type: 'POST',
	 url: siteurl + 'account/setinfo/profile',
	 dataType: 'json',
	 data: {login_id:login_id, name:name, petname:petname, aboutpet:aboutpet, willing_distance:willing_distance, pet_color:pet_color,  who_play_breed:who_play_breed, breed_specific:breed_specific,image:pet_image,petage:petage,petlocation:petlocation, pet_image_1:image_1, pet_image_2:image_2,pet_image_3:image_3,pet_image_4:image_4},
	 crossDomain: true,
	 success: function(data){
		 
		 $('input, textarea, select').removeClass('req');
		 
		 if(data['error'])
		 {
			 if(data['error']['name'])  $('#name').addClass('req');
			 if(data['error']['petname']) $('#petname').addClass('req');
			 //if(data['error']['aboutpet']) $('#aboutpet').addClass('req');
			 if(data['error']['willing_distance']) $('#willing_distance').addClass('req');
			 if(data['error']['pet_color']) $('#pet_color').addClass('req');
			 if(data['error']['petage']) $('#petage').addClass('req');
			 if(data['error']['petlocation']) $('#petlocation').addClass('req');
		 }
		 
	   	if(data['success'])
		{
			$('#common_popup').html('Profile updated auccessfully.');
			$('#modal_common').modal('show');
		}
	   }
   });
}

$.ajax({
	 type: 'POST',
	 url: siteurl + 'common/common/getAccount',
	 dataType: 'json',
	 data: {login_id:login_id},
	 crossDomain: true,
	 success: function(data){
			$('input[name="name"]').val(data['success']['name']);
			$('input[name="petage"]').val(data['success']['age']);
			$('input[name="petlocation"]').val(data['success']['location']);
			$('input[name="petname"]').val(data['success']['petname']);
			$('textarea[name="aboutpet"]').val(data['success']['aboutpet']);
			$('input[name="pet_color"]').val(data['success']['pet_color']);
			
			$('#sex [value="'+ data['success']['pet_sex'] +'"]').attr('selected', 'true');
			$('#willing_distance [value="'+ data['success']['willing_distance'] +'"]').attr('selected', 'true');
			
			if(data['success']['who_play_breed'])
			{
				$('#who_play_breed [value="'+ data['success']['who_play_breed'] +'"]').attr('selected', 'true');
				$('select[name="who_play_breed"]').trigger('change');
				
				if(data['success']['who_play_breed'] == 2)
				{
					$('#specific_breed [value="'+ data['success']['breed_specific'] +'"]').attr('selected', 'true');
				}
			}
			
			if(data['success']['image'])
			{
				$('#pet_image_src').attr('src', data['success']['image']);
				$('input[name="pet_image"]').val(data['success']['image_name']);	
			}
	   }
   });
</script>
</body>
</html>